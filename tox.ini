[tox]
envlist = global-init,py39-numpy{2.0},py310-numpy{2.0,2.1,2.2},py311-numpy{2.0,2.1,2.2,2.3},py312-numpy{2.0,2.1,2.2,2.3},py313-numpy{2.1,2.2,2.3},global-finalize

[gh-actions]
python =
    3.9: py39
    3.10: py310
    3.11: py311
    3.12: py312
    3.13: py313

[testenv:global-init]
skip_install = True
usedevelop = False
deps =
    coverage
commands = coverage erase

[testenv]
usedevelop = True
deps =
    pytest
    pytest-cov
    numpy2.0: numpy>=2.0,<2.1
    numpy2.1: numpy>=2.1,<2.2
    numpy2.2: numpy>=2.2,<2.3
    numpy2.3: numpy>=2.3,<2.4
setenv =
    COVERAGE_FILE = {toxworkdir}/.coverage.{envname}
commands = py.test test -v --cov=plyfile

[testenv:global-finalize]
skip_install = True
usedevelop = False
deps =
    coverage
setenv =
    COVERAGE_FILE = {toxworkdir}/.coverage
commands =
    coverage combine
    coverage html -d {toxworkdir}/htmlcov
